<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dimonds Hotels — Listings</title>
  <style>
    :root{--accent:#0f766e;--muted:#475569}
    *{box-sizing:border-box}
    body{font-family:Inter,Arial;background:#f7fafc;margin:0;color:#0f172a}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .filters{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px}
    .panel{background:#fff;padding:12px;border-radius:12px;box-shadow:0 6px 22px rgba(2,6,23,0.06)}
    .list{display:grid;grid-template-columns:1fr;gap:12px}
    .hotel{display:flex;gap:12px;align-items:center;padding:12px;border-radius:10px}
    .hotel .img{width:140px;height:100px;border-radius:10px;background:linear-gradient(135deg,#e6fffa,#cffafe);display:flex;align-items:end;padding:10px;font-weight:700}
    .hotel .info{flex:1}
    .controls{display:flex;gap:8px;align-items:center}
    input,select{padding:10px;border-radius:8px;border:1px solid #e6eef8}
    button{padding:10px 12px;border-radius:8px;border:0;background:var(--accent);color:#fff;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    @media (min-width:760px){.list{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h2>Available Hotels</h2>
        <div class="muted" id="querySummary">—</div>
      </div>
      <div class="controls">
        <select id="sortSelect" onchange="applyFilters()">
          <option value="recommended">Recommended</option>
          <option value="priceAsc">Price: Low to High</option>
          <option value="priceDesc">Price: High to Low</option>
          <option value="ratingDesc">Rating: Best</option>
        </select>
        <button onclick="goBack()">New Search</button>
      </div>
    </header>
 
    <div class="filters panel">
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <div><label class="muted">Type</label><select id="typeFilter"><option value="all">All</option><option>Luxury</option><option>Resort</option><option>Boutique</option><option>Budget</option></select></div>
        <div><label class="muted">Max price per night</label><input id="priceMax" type="number" placeholder="e.g., 120" /></div>
        <div><label class="muted">Min rating</label><input id="minRating" type="number" step="0.1" placeholder="e.g., 4.0" /></div>
        <div style="margin-left:auto"><button onclick="resetFilters()">Reset</button></div>
      </div>
    </div>
 
    <div id="list" class="list" style="margin-top:12px"></div>
  </div>
 
<script>
  function qs(){return new URLSearchParams(location.search)}
  const params=qs();
  const destination=params.get('destination')||'';
  const checkin=params.get('checkin')||'';
  const checkout=params.get('checkout')||'';
 
  document.getElementById('querySummary').textContent = `${destination ? destination+' • ' : ''}${checkin ? checkin+' to ' : ''}${checkout ? checkout : ''}`;
 
  let hotels = JSON.parse(localStorage.getItem('dimonds_hotels')||'[]');
 
  function renderList(items){
    const list=document.getElementById('list');list.innerHTML='';
    if(items.length===0){list.innerHTML='<div class="panel">No hotels match your filters.</div>';return}
    items.forEach(h=>{
      const el=document.createElement('div');el.className='panel hotel';
      el.innerHTML=`
        <div class="img">${h.name}</div>
        <div class="info">
          <div style="font-weight:700">${h.name}</div>
          <div class="muted">${h.city} • ${h.type} • ⭐ ${h.rating}</div>
          <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:800">$${h.price}/night</div>
            <div><button onclick="viewHotel(${h.id})">View & Book</button></div>
          </div>
        </div>
      `;
      list.appendChild(el);
    })
  }
 
  function applyFilters(){
    const type=document.getElementById('typeFilter').value;
    const priceMax=parseFloat(document.getElementById('priceMax').value)||Infinity;
    const minRating=parseFloat(document.getElementById('minRating').value)||0;
    const sort=document.getElementById('sortSelect').value;
 
    let filtered = hotels.filter(h=>{
      if(type!=='all' && type!=='' && h.type!==type) return false;
      if(h.price>priceMax) return false;
      if(h.rating<minRating) return false;
      if(destination && !h.city.toLowerCase().includes(destination.toLowerCase()) && !h.name.toLowerCase().includes(destination.toLowerCase())) return false;
      return true;
    });
 
    if(sort==='priceAsc') filtered.sort((a,b)=>a.price-b.price);
    if(sort==='priceDesc') filtered.sort((a,b)=>b.price-a.price);
    if(sort==='ratingDesc') filtered.sort((a,b)=>b.rating-a.rating);
 
    renderList(filtered);
  }
 
  function viewHotel(id){
    const q=new URLSearchParams({id,checkin,checkout}).toString();
    window.location.href='hotel.html?'+q;
  }
 
  function goBack(){ window.location.href='index.html'; }
  function resetFilters(){document.getElementById('typeFilter').value='all';document.getElementById('priceMax').value='';document.getElementById('minRating').value='';document.getElementById('sortSelect').value='recommended';applyFilters();}
 
  // init
  applyFilters();
</script>
</body>
</html>
